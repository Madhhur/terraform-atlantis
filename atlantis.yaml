version: 3
workflows:
  custom-workflow:
    plan:
      steps:
        - run: echo "Running custom step before init"
        - init: terraform init -upgrade
        - plan: terraform plan -out=tfplan
    apply:
      steps:
        - run: echo "Running custom step before apply"
        - apply: terraform apply tfplan
projects:
  - dir: .
    workspace: default
    workflow: custom-workflow
