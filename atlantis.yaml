version: 3
workflows:
  custom-workflow:
    plan:
      steps:
        - run: echo "Running custom step bedfore init1"
        - run: terraform init -upgrade
        - run: terraform plan -out=tfplan
    apply:
      steps:
        - run: echo "Running custom step before apply"
        - run: terraform apply tfplan
projects:
  - dir: .
    workspace: default
    workflow: custom-workflow
